# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1vJom8Rckpz5MBgPYwFEd4DAesamEncyE
"""

import pandas as pd
from sklearn.preprocessing import LabelEncoder, StandardScaler

data = pd.read_csv('dataset.csv')

data['TotalCharges'] = pd.to_numeric(data['TotalCharges'], errors='coerce')

data['TotalCharges'].fillna(data['TotalCharges'].median(), inplace=True)

categorical_columns = ['gender', 'Partner', 'Dependents', 'PhoneService', 'MultipleLines',
                       'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection',
                       'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract',
                       'PaperlessBilling', 'PaymentMethod', 'Churn']

label_encoders = {}
for col in categorical_columns:
    le = LabelEncoder()
    data[col] = le.fit_transform(data[col])
    label_encoders[col] = le

numeric_columns = ['tenure', 'MonthlyCharges', 'TotalCharges']
scaler = StandardScaler()
data[numeric_columns] = scaler.fit_transform(data[numeric_columns])

data.drop(columns=['customerID'], inplace=True)

data.to_csv('preprocessed_dataset.csv', index=False)

print("Data preprocessing complete. Preprocessed dataset saved as 'preprocessed_dataset.csv'.")
